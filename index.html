<html>
  <head>
   <link rel="stylesheet" type="text/css" href="css/powerwidgets.css">
   <link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet">
   <link href="https://fonts.googleapis.com/css?family=Fredoka+One" rel="stylesheet">
  </head>
  <body  onresize="initSpider(event);initPoligons()">
  <div class="indicators">

    <div class="indicator indicatora">

      <div class="powerTitle">My  preparedness</div>
      <div  style="display: flex;flex-direction: row;justify-content: space-around;">

      <svg
         class="progress-ring"
         width="120"
         fill="#13377f"
         height="120"
         shape-rendering="geometricPrecision"
         >
        <circle
          id="circ_1"
          class="progress-ring__circle"
          transform="rotate(-90 0 0)"
          stroke="#6d0949"
          stroke-width="50"
          fill="#13377f"
          r="30"
          cx="60"
          cy="60"/>
        <circle
          stroke="white"
          stroke-width="2"
          fill="#6d0949"
          r="30"
          cx="60"
          cy="60"/>
        <circle
          stroke="#6d0949"
          stroke-width="2"
          fill="transparent"
          r="57"
          cx="60"
          cy="60"/>
        <image xlink:href="img/idea.png" height="120" width="120"  rx="15" ry="15" />

      </svg>
      <svg
         class="progress-ring"
         width="120"
         fill="#13377f"
         height="120"
         shape-rendering="geometricPrecision"
         >
        <circle
          class="progress-ring__circle"
          transform="rotate(-90 0 0)"
          stroke="#13377f"
          stroke-width="50"
          fill="#13377f"
          r="30"
          cx="60"
          cy="60"
          id="circ_2"
          />
        <circle
          stroke="white"
          stroke-width="2"
          fill="#13377f"
          r="30"
          cx="60"
          cy="60"/>
        <circle
          stroke="#13377f"
          stroke-width="2"
          fill="transparent"
          r="57"
          cx="60"
          cy="60"/>
        <image xlink:href="img/prob_awe.png" height="120" width="120"  rx="15" ry="15" />
      </svg>
      <svg
         class="progress-ring"
         width="120"
         fill="#493f8d"
         height="120"
         shape-rendering="geometricPrecision"
         >
        <circle
          class="progress-ring__circle"
          transform="rotate(-90 0 0)"
          stroke="#493f8d"
          stroke-width="50"
          fill="#493f8d"
          r="30"
          cx="60"
          cy="60"
          id="circ_3"
          />
        <circle
          stroke="white"
          stroke-width="2"
          fill="#493f8d"
          r="30"
          cx="60"
          cy="60"/>
        <circle
          stroke="#493f8d"
          stroke-width="2"
          fill="transparent"
          r="57"
          cx="60"
          cy="60"/>
        <image xlink:href="img/ready_act.png" height="120" width="120"  rx="15" ry="15" />

      </svg>
    </div>

    </div>
      <!-- <input
        value="35"
        type="number"
        step="5"
        min="0"
        max="100"
        placeholder="progress"
        style="margin-left:150px"
        id="input1"
      >
      <input
        value="35"
        type="number"
        step="5"
        min="0"
        max="100"
        placeholder="progress"
        style="margin-left:300px"
        id="input2"
      >
      <input
        value="35"
        type="number"
        step="5"
        min="0"
        max="100"
        placeholder="progress"
        style="margin-left:450px"
        id="input3"
      > -->
      <div class="indicator indicatorb">
        <div class="powerTitle">My Impact</div>

      <div class="powerRow">
        <div class="powerBartitle">Political</div><div class="powerBarWrapper">
          <div class="iconWrapper political">
            <img src="img/political.png" class="icon political"/>
          </div>
          <div class="pwrapper">
            <div class="powerBar political">
              <div class="fill political" style="width: 0%;" id="powerBar1"></div>
            </div>
          </div>
        </div>
      </div>
      <div class="powerRow">
        <div class="powerBartitle">Social</div><div class="powerBarWrapper">
          <div class="iconWrapper social">
            <img src="img/users-group.png" class="icon political"/>
          </div>
          <div class="pwrapper">
            <div class="powerBar social">
              <div class="fill social" style="width: 50%;" id="powerBar2"></div>
            </div>
          </div>
        </div>
      </div>
      <div class="powerRow">
      <div class="powerBartitle">Individual</div><div class="powerBarWrapper">
          <div class="iconWrapper individual">
            <img src="img/people.png" class="icon political"/>
          </div>
          <div class="pwrapper">
            <div class="powerBar individual">
              <div class="fill individual" style="width: 100%;" id="powerBar3"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="indicator indicatorc">
      <div class="powerTitle">My Flood Warden Level (based on preparedness)</div>
      <div class="powerContent">
        <div class="warden">
          <div class="badge earned" >
            <img src="img/badge1.png"/>
            <div class="level_lbl">Level 1</div>
          </div>
          <div id="warden_bar_1">
            <div id="warden_bar1_fill"  style="width:0%"></div>
          </div>
          <div class="badge " id="badge2">
            <img src="img/badge2.png" id="badge_img2"/>
            <div class="level_lbl">Level 2</div>
          </div>
          <div id="warden_bar_2">
            <div id="warden_bar2_fill" style="width:0%"></div>
          </div>
          <div class="badge " id="badge3">
            <img src="img/badge3.png" id="badge_img3"/>
            <div class="level_lbl">Level 3</div>
          </div>
        </div>

      </div>

    </div>
    <div class="indicator indicatord">
      <div class="powerTitle">Community Preparedness</div>
      <div style="margin-left:auto;margin-right:auto;">
        <canvas id="spider" height="450" width="750"></canvas>
      </div>

    </div>

  </div>
</div>
  </body>
<script>
var circle = document.getElementById("circ_1");
var radius = circle.r.baseVal.value;
var circumference = radius * 2 * Math.PI;

var circle2 = document.getElementById("circ_2");
var radius2 = circle.r.baseVal.value;
var circumference2 = radius2 * 2 * Math.PI;

var circle3 = document.getElementById("circ_3");
var radius3 = circle.r.baseVal.value;
var circumference3 = radius3 * 2 * Math.PI;

circle.style.strokeDasharray = `${circumference} ${circumference}`;
circle.style.strokeDashoffset = `${circumference}`;
circle2.style.strokeDasharray = `${circumference} ${circumference}`;
circle2.style.strokeDashoffset = `${circumference}`;
circle3.style.strokeDasharray = `${circumference} ${circumference}`;
circle3.style.strokeDashoffset = `${circumference}`;


function setProgress(percent) {
  const offset = circumference - percent / 100 * circumference;
  circle.style.strokeDashoffset = offset;
}

const input = document.getElementById('input1');
/*setProgress(input.value);

input.addEventListener('change', function(e) {
  if (input.value < 101 && input.value > -1) {
    setProgress(input.value);
  }
})*/
// 2




function setProgress2(percent) {
  const offset2 = circumference2 - percent / 100 * circumference2;
  circle2.style.strokeDashoffset = offset2;
}

const input2 = document.getElementById('input2');
/*setProgress2(input2.value);

input2.addEventListener('change', function(e) {
  if (input2.value < 101 && input2.value > -1) {
    setProgress2(input2.value);
  }
})*/

// 3


function setProgress3(percent) {
  const offset3 = circumference3 - percent / 100 * circumference3;
  circle3.style.strokeDashoffset = offset3;
}

const input3 = document.getElementById('input3');
/*setProgress3(input3.value);

input3.addEventListener('change', function(e) {
  if (input3.value < 101 && input3.value > -1) {
    setProgress3(input3.value);
  }
})*/
function changeProgress(){
  setProgress(33);
  setProgress2(66);
  setProgress3(100);
}
setTimeout(function(){ changeProgress() }, 1000);
function setProgressPowerBar(p,n){
  _pbar = document.getElementById("powerBar"+n);
  _pbar.style.width = p + "%";
}
function setWardenProgress(p){
  if(p < 100){
    // set only level 1, disable all the rest
    document.getElementById("warden_bar1_fill").style.width = p + "%"
    document.getElementById("warden_bar2_fill").style.width = "0%"
    document.getElementById("badge2").classList.remove("earned")
    document.getElementById("badge3").classList.remove("earned")
    document.getElementById("badge_img2").src = "img/badge2.png";
    document.getElementById("badge_img3").src = "img/badge3.png";

  }else{
    document.getElementById("warden_bar1_fill").style.width = "100%"
    document.getElementById("warden_bar2_fill").style.width = (Math.abs(100 - p) + "%");
    document.getElementById("badge2").classList.add("earned")
    document.getElementById("badge_img2").src = "img/badge2_earned.png";
    document.getElementById("badge_img3").src = "img/badge3.png";
    document.getElementById("badge3").classList.remove("earned")


    if(p >= 200){
      document.getElementById("badge3").classList.add("earned")
      document.getElementById("badge_img3").src = "img/badge3_earned.png";
    }
  }
}
function initSpider(){
  var canvas = document.getElementById("spider");
  var ctx = canvas.getContext("2d");
  c = 200;
  var sizeWidth = ctx.canvas.clientWidth;
  var sizeHeight = ctx.canvas.clientHeight;
  var scaleWidth = sizeWidth/100;
  var scaleHeight = sizeHeight/100;
  centerX = sizeWidth/2;
  centerY = sizeHeight/2;
  r = sizeWidth/2 - c;

  ctx.clearRect(0, 0, canvas.width, canvas.height);
  ctx.beginPath();
  // console.log(sizeWidth/2);
  // console.log(sizeHeight/2);
  ctx.beginPath();
  ctx.arc(centerX,centerY,1,0,2*Math.PI)
  ctx.strokeStyle = '#d7dadd';
  _goals  = [0,3,6]
  // draw 10 lines, all with the same distance between each other
  for (var i = 0; i < 11; i++) {
    if(_goals.includes(i)){
      ctx.lineWidth   = 2;
      ctx.strokeStyle = '#848177';
    }else{
      ctx.lineWidth   = 1;
      ctx.strokeStyle = '#d7dadd';
    }
    ctx.beginPath();
    ctx.arc(sizeWidth/2,sizeHeight/2, r - ( i *  r / 10 ) ,0,2*Math.PI)
    ctx.stroke();


  }

  _degrees = [0,40,80,120,160,200,240,280,320];
  _labels  = [" Ready to act","Awareness","Know-how","Ready to act","Awareness","Know-how","Ready to act","Awareness","   Know-how",]
  _offset = 10; //All lines will be turned with this offset.
  _extraRadius = 20;
  ctx.lineWidth   = 1;
  _labelColors = ["#1786e0", "#e23d3d","#2dc463"]
  _degrees.forEach(function(d,i){
    ctx.beginPath();
    ctx.moveTo(centerX ,centerY);
    // convert angles to radians. Add offset
    rx = (d + _offset)  * (Math.PI /180);
    ry = (d + _offset) * (Math.PI /180);
    x = centerX + (r * 1.1) * Math.cos(rx);
    y = centerY + (r * 1.1) * Math.sin(ry);
    ctx.lineTo(x,y);
    ctx.font = "13px Arial";
    rx = (d + _offset)  * (Math.PI /180);
    ry = (d + _offset) * (Math.PI /180);
    x = centerX + r*1.17  * Math.cos(rx);
    y = centerY + r*1.17 * Math.sin(ry);
    if(i < 4){
      textOffset = 20;
    }else{
      textOffset = 40;
    }
    if(i < 2 ){
      ctx.fillStyle = _labelColors[0];
    }else if(i > 2 && i < 5){
      ctx.fillStyle = _labelColors[1];
    }else if(i > 5){
      ctx.fillStyle = _labelColors[2];
    }else if(i >= _degrees.length -1){
      ctx.fillStyle = _labelColors[0];
    }

    ctx.fillText(_labels[i],x-textOffset,y);

    ctx.stroke();

  });


  ctx.closePath();

}

function addGoals(){
  _degrees = [0,20,30,60,160,200,240,280,320,360];
  _offset = 10; //All lines will be turned with this offset.
  var canvas = document.getElementById("spider");
  var ctx = canvas.getContext("2d");
  var sizeWidth = ctx.canvas.clientWidth;
  var sizeHeight = ctx.canvas.clientHeight;
  var scaleWidth = sizeWidth/100;
  var scaleHeight = sizeHeight/100;
  values = [4,7,10]
  _labels = ["(2% more prepared)", "(5% more prepared)","(10% more prepared)"]
  values.forEach(function(v,i){
    vi = Math.abs(v - _degrees.length);
    _rd  = r - ( vi  *  r / 10 ) //radius distance
    // convert angles to radians. Add offset
    // convert angles to radians. Add offset
    rx = (_degrees[0+i] + _offset)  * (Math.PI /180);
    ry = (_degrees[0+i] + _offset) * (Math.PI /180);
    x = centerX + _rd * Math.cos(rx);
    y = centerY + _rd * Math.sin(ry);
    ctx.beginPath();
    ctx.lineWidth   = 2;
    ctx.strokeStyle = '#848177';
    ctx.moveTo(x,y);
    ctx.lineTo(sizeWidth,y);
    ctx.fillStyle   = "#848177";
    if( v == 4){
      ctx.font = "bold 16px Arial";
      ctx.fillText("Goals",sizeWidth - 45,y-15);
    }
    ctx.font = "13px Arial";

    if(v == 10){
      ctx.fillText(_labels[i],sizeWidth - 122,y+15);
    }else{
      ctx.fillText(_labels[i],sizeWidth - 115,y+15);
    }
    ctx.stroke();
  });
}

function addPoligons(values,dashed){
  _degrees = [0,40,80,120,160,200,240,280,320,360];
  _offset = 10; //All lines will be turned with this offset.
  var canvas = document.getElementById("spider");
  var ctx = canvas.getContext("2d");
  var sizeWidth = ctx.canvas.clientWidth;
  var sizeHeight = ctx.canvas.clientHeight;
  var scaleWidth = sizeWidth/100;
  var scaleHeight = sizeHeight/100;
  c = 200;
  centerX = sizeWidth/2;
  centerY = sizeHeight/2;
  r = sizeWidth/2 - c;
  ctx.lineWidth   = 2;
  ctx.beginPath();
  if(dashed){
    ctx.setLineDash([100]);
    ctx.strokeStyle = '#84561a';
  }else{
    ctx.strokeStyle = '#293b47';

  }
  values.forEach(function(v,i){
    vi = Math.abs(v - _degrees.length);
    _rd  = r - ( vi  *  r / 10 ) //radius distance
    // convert angles to radians. Add offset
    // convert angles to radians. Add offset
    rx = (_degrees[i] + _offset)  * (Math.PI /180);
    ry = (_degrees[i] + _offset) * (Math.PI /180);
    x = centerX + _rd * Math.cos(rx);
    y = centerY + _rd * Math.sin(ry);
    ctx.lineTo(x,y);
    if(dashed){
      ctx.setLineDash([3]);
    }
    ctx.moveTo(x,y);

  });
  ctx.closePath();
  ctx.stroke();
  if(dashed){
    ctx.setLineDash([.0001]);
  }
  ctx.fillStyle="#1786e0";
  ctx.fillStyle="#e23d3d";
  ctx.fillStyle="#2dc463";
  values.forEach(function(v,i){
    vi = Math.abs(v - _degrees.length);
    _rd  = r - ( vi  *  r / 10 ) //radius distance
    // convert angles to radians. Add offset
    // convert angles to radians. Add offset
    rx = (_degrees[i] + _offset)  * (Math.PI /180);
    ry = (_degrees[i] + _offset) * (Math.PI /180);
    x = centerX + _rd * Math.cos(rx);
    y = centerY + _rd * Math.sin(ry);

    if(i < 2 ){
      ctx.fillStyle="#2dc463";
    }else if(i > 2 && i < 5){
      ctx.fillStyle="#e23d3d";
    }else if(i > 5){
      ctx.fillStyle="#1786e0";
    }else if(i >= _degrees.length -1){
      ctx.fillStyle="#2dc463";
    }
    if(i <= _degrees.length -2){
      ctx.beginPath();
      ctx.arc(x,y,5,0,2*Math.PI)
      ctx.closePath();
      ctx.fill();
      ctx.arc(x,y,6,0,2*Math.PI)
      ctx.stroke();
    }



  });
  ctx.closePath();

}
window.onload = function()
 {
      initSpider();
      initPoligons();
 }
 function initPoligons(){
   addGoals();
   addPoligons([10,10,10,10,10,10,10,10,10,10],false);
   addPoligons([3,3,3,3,3,3,3,3,3,3],true);


 }
</script>
</html>
